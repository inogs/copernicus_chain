#per creare gli ambienti virtuali python per il postproc della catena
. $OPA_HOME/src/ENV/$OPA_HOSTNAME

module load autoload profile/advanced

case $OPA_HOSTNAME in
    pico)
      module load autoload profile/advanced
      module load intelmpi netcdf/4.1.3--intel--cs-xe-2015--binary
      module load python/2.7.9 numpy/1.9.2--python--2.7.9 matplotlib/1.4.3--python--2.7.9
      ;;
    galileo)
      module load autoload
      module load intelmpi/2018--binary
      module load python/2.7.12
      export HDF5_DIR=$OPA_HOME/HOST/$OPA_HOSTNAME
      export NETCDF4_DIR=$OPA_HOME/HOST/$OPA_HOSTNAME
      export GEOS_DIR=$OPA_HOME/HOST/$OPA_HOSTNAME
      ;;
    marconi)
      module load autoload 
      module load profile/advanced intelmpi/2017--binary netcdf/4.4.1--intelmpi--2017--binary
      module load python/2.7.12 numpy/1.11.2--python--2.7.12
      ;;
    meucci)
      module load autoload intelmpi/2017--binary #netcdf/4.4.1--intelmpi--2017--binary
      module load python/2.7.12 #numpy/1.11.2--python--2.7.12
      export HDF5_DIR=$OPA_HOME/HOST/$OPA_HOSTNAME
      export NETCDF4_DIR=$OPA_HOME/HOST/$OPA_HOSTNAME
      export GEOS_DIR=$OPA_HOME/HOST/$OPA_HOSTNAME
      ;;
    *)
      module load python
      ;;
esac

#creazione di venv
VENV_PATH=$OPA_HOME/HOST/$OPA_HOSTNAME/venv

virtualenv $VENV_PATH

source $VENV_PATH/bin/activate
pip install --upgrade pip
pip install cftime==1.1.1
CFLAGS+="-L/cineca/prod/opt/compilers/intel/pe-xe-2018/binary/lib/intel64 -lsvml -limf -lirc" CC=mpiicc pip install netcdf4 --global-option=build_ext
pip install ipython
pip install mpi4py
pip install python-dateutil
pip install scipy
pip install seawater
pip install matplotlib
pip install git+https://github.com/matplotlib/basemap.git
pip install latexcodec
#installare Pillow per concludere la configurazione di venv1

